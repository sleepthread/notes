

online-inspection-tracker
https://github.com/TheCoolQATeam/online-inspection-tracker

çº¿ä¸ŠUIè‡ªåŠ¨åŒ–å·¡æ£€ç³»ç»Ÿ
[check.itest.ren/](https://check.itest.ren/ "https://check.itest.ren/")

## é¡¹ç›®åç§°

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E9%A1%B9%E7%9B%AE%E5%90%8D%E7%A7%B0)

çº¿ä¸ŠUIè‡ªåŠ¨åŒ–å·¡æ£€é¡¹ç›®

## ç®€ä»‹

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E7%AE%80%E4%BB%8B)

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªçº¿ä¸ŠUIè‡ªåŠ¨åŒ–å·¡æ£€å·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘äººå‘˜å’Œæµ‹è¯•äººå‘˜å¿«é€Ÿã€é«˜æ•ˆåœ°æ£€æµ‹çº¿ä¸ŠWebåº”ç”¨çš„UIç•Œé¢æ˜¯å¦å­˜åœ¨å¼‚å¸¸ã€‚é€šè¿‡è‡ªåŠ¨åŒ–å·¡æ£€ï¼Œå¯ä»¥åŠæ—¶å‘ç°å¹¶ä¿®å¤æ½œåœ¨çš„é—®é¢˜ï¼Œæå‡ç”¨æˆ·ä½“éªŒå’Œäº§å“è´¨é‡ã€‚

## demo

[](https://github.com/TheCoolQATeam/online-inspection-tracker#demo)

- åœ°å€ï¼š[https://check.itest.ren/](https://check.itest.ren/)Â @zdx0122

- æ¬¢è¿å„ä½å¼€å‘è€…æä¾›å·²éƒ¨ç½²çš„é¡¹ç›®ä¾›å¤§å®¶è®¿é—®ä½¿ç”¨ï¼Œå…±äº«å·¡æ£€èµ„æº

## åŠŸèƒ½ç‰¹ç‚¹

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E5%8A%9F%E8%83%BD%E7%89%B9%E7%82%B9)

- è‡ªåŠ¨åŒ–å·¡æ£€ï¼šå®šæ—¶æˆ–å®æ—¶æ‰§è¡Œå·¡æ£€ä»»åŠ¡ï¼Œæ— éœ€äººå·¥å¹²é¢„ã€‚
- å¤šç§å·¡æ£€è§„åˆ™ï¼šæ”¯æŒæ ‡é¢˜å¯¹æ¯”ï¼Œé¡µé¢è§†è§‰å›å½’ã€‚
- å®æ—¶åé¦ˆï¼šå·¡æ£€ç»“æœå®æ—¶å±•ç¤ºï¼ŒåŒ…æ‹¬é—®é¢˜æˆªå›¾ã€é—®é¢˜æè¿°å’Œå®šä½ä¿¡æ¯ã€‚
- è·¨å¹³å°æ”¯æŒï¼šæ”¯æŒä¸»æµæµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿï¼Œæ»¡è¶³ä¸åŒç¯å¢ƒéœ€æ±‚ã€‚

## ä½¿ç”¨è¯´æ˜

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E)

### å®‰è£…ä¸éƒ¨ç½²

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E5%AE%89%E8%A3%85%E4%B8%8E%E9%83%A8%E7%BD%B2)

- å…‹éš†æœ¬é¡¹ç›®è‡³æœ¬åœ°ã€‚
- Dockeréƒ¨ç½²ï¼Œå‚è€ƒ doc/docker éƒ¨ç½²æ‰‹å†Œ.md
- æœ¬åœ°å¯åŠ¨
    
    - åŸºç¡€ç¯å¢ƒï¼šnodejsã€jdk1.8ã€maven
    - mysql: å»ºè¡¨è¯­å¥db/ddl.sql
    - online-server springbooté¡¹ç›®ï¼Œå®‰è£…ä¾èµ–åï¼Œä¸€é”®å¯åŠ¨å³å¯ï¼Œè®¿é—®åœ°å€ï¼šè®¿é—®åœ°å€ï¼š[http://127.0.0.1:9091/](http://127.0.0.1:9091/)
    - online-client vueé¡¹ç›®ï¼Œè®¿é—®åœ°å€ï¼š[http://127.0.0.1:5173/](http://127.0.0.1:5173/)
    
    ```
    npm install    //å®‰è£…ä¾èµ–
    npm run dev    // å¯åŠ¨
    ```
    

### å·¡æ£€ç”¨ä¾‹å½•å…¥

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E5%B7%A1%E6%A3%80%E7%94%A8%E4%BE%8B%E5%BD%95%E5%85%A5)

- ç‚¹å‡»å·¦ä¾§èœå•â€œH5ç”¨ä¾‹â€
- ç‚¹å‡»â€œæ–°å¢â€æŒ‰é’®
- å¡«å†™ç”¨ä¾‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬H5é¡µé¢æ ‡é¢˜ã€å·¡æ£€URLåœ°å€ã€ä¸šåŠ¡çº¿ã€é’‰é’‰/ä¼å¾®/é£ä¹¦å‘Šè­¦ç¾¤æœºå™¨äººçš„keyå€¼ç­‰
- æäº¤

### å·¡æ£€è§„åˆ™

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E5%B7%A1%E6%A3%80%E8%A7%84%E5%88%99)

- æ¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡å·¡æ£€ä»»åŠ¡
- å·¡æ£€å†…å®¹
    - é¡µé¢å¯ç”¨æ€§æ£€æµ‹ï¼ˆç™½å±ï¼‰
    - é¡µé¢åƒç´ æ¯”å¯¹ï¼ˆç›¸ä¼¼åº¦<60%ï¼‰
    - ç”¨ä¾‹æ‰§è¡Œæ—¶é•¿ç»Ÿè®¡

### å·¡æ£€ç»“æœ

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E5%B7%A1%E6%A3%80%E7%BB%93%E6%9E%9C)

- å·¡æ£€ç»“æœå°†å®æ—¶å±•ç¤ºåœ¨æŒ‡å®šé¡µé¢ä¸­ã€‚
- èœå•â€œå·¡æ£€è®°å½•â€ï¼Œå¯ä»¥æŸ¥çœ‹ä»Šæ—¥å·¡æ£€è®°å½•ã€‚
- èœå•â€œæ•°æ®çœ‹æ¿â€ï¼Œå¯ä»¥è¿‘ä¸€æ®µæ—¶é—´ç”¨ä¾‹æ‰§è¡Œæ•°æ®ã€‚

### å¼‚å¸¸ç”¨ä¾‹å‘Šè­¦

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E5%BC%82%E5%B8%B8%E7%94%A8%E4%BE%8B%E5%91%8A%E8%AD%A6)

- é¡µé¢æ ‡é¢˜æ¯”å¯¹é”™è¯¯ï¼Œå‘Šè­¦é€šçŸ¥ï¼ˆéœ€é…ç½®ç¾¤æœºå™¨äººkeyï¼‰
- é¡µé¢åƒç´ æ¯”å¯¹ç›¸ä¼¼åº¦<60%ï¼Œå‘Šè­¦é€šçŸ¥ï¼ˆéœ€é…ç½®ç¾¤æœºå™¨äººkeyï¼‰

## æŠ€æœ¯æ ˆ

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E6%8A%80%E6%9C%AF%E6%A0%88)

- ç¼–ç¨‹è¯­è¨€ï¼šJAVA
- æ¡†æ¶ï¼šSpringBoot
- è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼šplaywright + testNg
- æ•°æ®åº“ï¼šMySQL(5.7)
- å‰ç«¯æŠ€æœ¯ï¼švue3

## è´¡çŒ®æŒ‡å—

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E8%B4%A1%E7%8C%AE%E6%8C%87%E5%8D%97)

æ¬¢è¿å„ä½å¼€å‘è€…è´¡çŒ®ä»£ç ã€æ–‡æ¡£å’Œå»ºè®®ã€‚åœ¨æäº¤è´¡çŒ®ä¹‹å‰ï¼Œè¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

Forkæœ¬é¡¹ç›®è‡³ä½ çš„GitHubä»“åº“ã€‚ åœ¨ä½ çš„ä»“åº“ä¸­åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°çš„å¼€å‘åˆ†æ”¯ã€‚ è¿›è¡Œä»£ç ä¿®æ”¹ã€æ·»åŠ æ–‡æ¡£æˆ–æäº¤å…¶ä»–è´¡çŒ®ã€‚ æäº¤ä½ çš„æ›´æ”¹å¹¶æ¨é€è‡³ä½ çš„GitHubä»“åº“ã€‚ å‘èµ·Pull Requestè‡³æœ¬é¡¹ç›®çš„ä¸»åˆ†æ”¯ã€‚ æˆ‘ä»¬å°†å¯¹æäº¤çš„Pull Requestè¿›è¡Œå®¡æŸ¥å’Œæµ‹è¯•ï¼Œä¸€æ—¦é€šè¿‡ï¼Œå°†åˆå¹¶è‡³ä¸»åˆ†æ”¯å¹¶å‘å¸ƒæ–°ç‰ˆæœ¬ã€‚

### è´¡çŒ®å·¡æ£€èµ„æº

[](https://github.com/TheCoolQATeam/online-inspection-tracker#%E8%B4%A1%E7%8C%AE%E5%B7%A1%E6%A3%80%E8%B5%84%E6%BA%90)

å—æœºå™¨èµ„æºé™åˆ¶ï¼Œdemoç«™ç‚¹ä»…èƒ½ä½¿ç”¨å°‘é‡URLä¾›å¤§å®¶ä½“éªŒï¼Œæ¬¢è¿å„ä½å¼€å‘è€…æä¾›å·²éƒ¨ç½²çš„é¡¹ç›®ä¾›å¤§å®¶è®¿é—®ä½¿ç”¨ï¼Œå…±äº«å·¡æ£€èµ„æº



lighthouse-ci
https://github.com/cloudyan/lighthouse-ci
# lighthouse-ci

[](https://github.com/cloudyan/lighthouse-ci#lighthouse-ci)

åŸºäºÂ [Lighthouse](https://github.com/GoogleChrome/lighthouse)Â å®ç°å·¡æ£€ç³»ç»Ÿ

ç‰¹å¾

- åœ¨æ¯ä¸ª PR æ—è¾¹è·å–ä¸€ä»½ Lighthouse æŠ¥å‘Šã€‚
- é˜²æ­¢å¯è®¿é—®æ€§ã€SEOã€ç¦»çº¿æ”¯æŒå’Œæ€§èƒ½æœ€ä½³å®è·µçš„å›å½’ã€‚
- éšç€æ—¶é—´çš„æ¨ç§»è·Ÿè¸ªæ€§èƒ½æŒ‡æ ‡å’Œ Lighthouse åˆ†æ•°ã€‚
- è®¾ç½®å¹¶ä¿ç•™è„šæœ¬å’Œå›¾åƒçš„æ€§èƒ½é¢„ç®—ã€‚
- å¤šæ¬¡è¿è¡Œ Lighthouse ä»¥å‡å°‘å·®å¼‚ã€‚
- æ¯”è¾ƒæ‚¨ç½‘ç«™çš„ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä»¥å‘ç°ä¸ªåˆ«èµ„æºçš„æ”¹è¿›å’Œé€€åŒ–ã€‚

### æ ¸å¿ƒæŒ‡æ ‡

[](https://github.com/cloudyan/lighthouse-ci#%E6%A0%B8%E5%BF%83%E6%8C%87%E6%A0%87)

- FP
- LCP

1. å¯ä»¥åœ¨Â `CI/CD`Â æµç¨‹ï¼Œæ„å»ºå®Œæˆè‡ªåŠ¨æ£€æŸ¥æ€§èƒ½ï¼Œåšæ€§èƒ½å®ˆå«
2. ä¹Ÿå¯ä»¥å¯¹çº¿ä¸ŠæœåŠ¡ï¼Œå®šæœŸæ£€æŸ¥æ€§èƒ½ï¼Œåšæ€§èƒ½å·¡æ£€
3. è¿˜å¯ä»¥æ‰©å±•è®¾è®¡ä¸ºè§†è§‰èµ°æŸ¥ææ•ˆæ–¹æ¡ˆ

å…·ä½“å®ç°ï¼Œå¯ä»¥ä½¿ç”¨Â `lighthouse`Â ä¹Ÿå¯ä»¥ä½¿ç”¨Â `lighthouse-ci`ã€‚

### æ€§èƒ½å®ˆå«

[](https://github.com/cloudyan/lighthouse-ci#%E6%80%A7%E8%83%BD%E5%AE%88%E5%8D%AB)

> æ€§èƒ½å®ˆå«æ˜¯ä¸€ç§ç³»ç»Ÿæˆ–å·¥å…·ï¼Œç”¨äºç›‘æ§å’Œç®¡ç†åº”ç”¨ç¨‹åºæˆ–ç³»ç»Ÿçš„æ€§èƒ½ã€‚å®ƒæ—¨åœ¨ç¡®ä¿åº”ç”¨ç¨‹åºåœ¨å„ç§è´Ÿè½½å’Œä½¿ç”¨æƒ…å†µä¸‹èƒ½å¤Ÿæä¾›ç¨³å®šå’Œè‰¯å¥½çš„æ€§èƒ½ã€‚

Lighthouse æ˜¯ä¸€ä¸ªå¼€æºçš„è‡ªåŠ¨åŒ–å·¥å…·ï¼Œæä¾›äº†å››ç§ä½¿ç”¨æ–¹å¼ï¼š

- Chrome DevTools
- Chromeæ’ä»¶
- Node CLI
- Nodeæ¨¡å—

æ¶æ„å¦‚ä¸‹

å›¾

æˆ‘ä»¬å¯å€ŸåŠ©Â `Lighthouse Node`Â æ¨¡å—ç»§æ‰¿åˆ°Â `CI/CD`Â æµç¨‹ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½åœ¨æ„å»ºé˜¶æ®µçŸ¥é“æˆ‘ä»¬çš„é¡µé¢å…·ä½“æ€§èƒ½ï¼Œå¦‚æœæŒ‡æ ‡ä¸åˆæ ¼ï¼Œé‚£ä¹ˆå°±ä¸ç»™åˆå¹¶Â `MR`



[Python](https://www.ruanx.net/tag/python/)

## è‡ªåŠ¨å·¡æ£€æ¡†æ¶çš„è®¾è®¡å’Œå®ç°

è®¾è®¡å¹¶å®ç°ä¸€å¥—è‡ªåŠ¨å·¡æ£€ç³»ç»Ÿï¼Œä»¥ ssh å’Œæµè§ˆå™¨å®šæœŸç›‘æµ‹æœåŠ¡çŠ¶æ€ã€‚

+   ![Ruan Xingzhi](https://www.ruanx.net/content/images/size/w100/2020/05/blue.jpeg)
    
    ## Ruan Xingzhi
    
    Welcome to my site and hope you have fun.
    
    [More posts](https://www.ruanx.net/author/blue/) by Ruan Xingzhi.
    
    [![Ruan Xingzhi](https://www.ruanx.net/content/images/size/w100/2020/05/blue.jpeg)](https://www.ruanx.net/author/blue/)

17 Dec 2024 â€¢ 13 min read

![è‡ªåŠ¨å·¡æ£€æ¡†æ¶çš„è®¾è®¡å’Œå®ç°](https://www.ruanx.net/content/images/size/w2000/2024/12/out-1.jpg)

### 0x00 èµ·å› 

è¯»è€…åº”è¯¥å·²ç»ç†Ÿæ‚‰å„ç§å„æ ·çš„ uptime botã€‚è¿™äº› bot å®šæœŸæ‰§è¡Œä»»åŠ¡ï¼ˆä¾‹å¦‚ ping ä¸€ä¸‹æœåŠ¡å™¨ã€çœ‹ä¸€çœ¼é¦–é¡µçš„ HTTP çŠ¶æ€ç æ˜¯å¦ä¸º 200ï¼‰ï¼Œç”Ÿæˆæ—¥å¿—ï¼Œäºæ˜¯æˆ‘ä»¬ä¾¿å¯ä»¥çŸ¥é“åœ¨è¿‡å»å‡ å¤©å†…ï¼ŒæœåŠ¡å™¨ down æœºçš„æ—¶é—´æœ‰å¤šé•¿ã€‚è¿™ç±»åº”ç”¨çš„å…¸å‹ä»£è¡¨æ˜¯ [louislam/uptime-kuma](https://github.com/louislam/uptime-kuma)ã€‚

![](https://www.ruanx.net/content/images/2024/12/image.png)

â–² æˆ‘ä»¬æ‰€ç†Ÿæ‚‰çš„ uptime-kuma ç•Œé¢

è€Œç¬”è€…é¢ä¸´çš„ä»»åŠ¡ï¼Œæ¯”å•çº¯çš„ uptime ç¨ç¨å¤æ‚ä¸€äº›ã€‚ç®€è€Œè¨€ä¹‹ï¼Œç¬”è€…æ‰‹ä¸Šæœ‰è‹¥å¹²å°æœåŠ¡å™¨ï¼Œä¸Šé¢è¿è¡Œç€å„ç§ä¸šåŠ¡ï¼›ç¬”è€…éœ€è¦å®šæœŸæ£€æŸ¥è¿™äº›ä¸šåŠ¡æ˜¯å¦æ­£å¸¸ï¼ŒæŒ‡æ ‡åŒ…å« web æœåŠ¡æ˜¯å¦å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€å†…å­˜åŠç£ç›˜å ç”¨ç­‰ã€‚æœ¬æ–‡å°†è¿™æ ·çš„æ—¥å¸¸æ£€æŸ¥ç§°ä¸ºâ€œå·¡æ£€â€ã€‚ä¸€åœºå·¡æ£€å¯èƒ½åŒ…å«ï¼š

+   ç”¨æµè§ˆå™¨æ‰“å¼€ç½‘ç«™ï¼Œç™»å½•è´¦å·ï¼Œè¿›å…¥å„ä¸ªé¡µé¢ï¼Œè§‚å¯Ÿæ˜¯å¦æ­£å¸¸
+   ssh è¿æ¥æœåŠ¡å™¨ï¼Œè¿è¡Œ htop ç­‰æŒ‡ä»¤
+   ç¼–å†™å·¡æ£€æŠ¥å‘Š

ä¸€ä½å·¥ä½œäººå‘˜å¯èƒ½éœ€è¦å·¡æ£€å¤šå°æœåŠ¡å™¨ï¼Œå¦‚æœäººå·¥æ‰§è¡Œæ‰€æœ‰å·¡æ£€æ­¥éª¤ï¼Œå¯¹å·¥ä½œè€…è€Œè¨€æ— å¼‚äºä½“åŠ›åŠ³åŠ¨ã€‚å¦ä¸€æ–¹é¢ï¼Œå·¡æ£€å‘˜ç›´æ¥ç”¨ ssh ç™»å½•æœåŠ¡å™¨ï¼Œå­˜åœ¨è¯¯æ“ä½œçš„é£é™©ï¼›å·¡æ£€æŠ¥å‘Šä¸­çš„ä¸€äº›å­—æ®µï¼ˆä¾‹å¦‚æ—¥æœŸï¼‰ä¹Ÿå®¹æ˜“è¯¯å¡«ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å®ç°ä¸€ä¸ªè‡ªåŠ¨å·¡æ£€ç³»ç»Ÿã€‚

### 0x01 åŸºç¡€å·¥å…·ï¼šåˆ©ç”¨ pexpect å®ç° ssh è‡ªåŠ¨åŒ–

æ˜¾ç„¶ï¼Œæ¬²å®ç°è‡ªåŠ¨å·¡æ£€ï¼Œåˆ™å¿…é¡»å…ˆèƒ½è‡ªåŠ¨åŒ–æ§åˆ¶ ssh å’Œæµè§ˆå™¨ã€‚æˆ‘ä»¬å…ˆæ¥è®¨è®º sshã€‚ç¬¬ä¸€ç§æ–¹æ¡ˆæ˜¯å»ºç«‹ ssh ä¿¡é“å‘æœåŠ¡ç«¯ä¼ è¾“æŒ‡ä»¤ï¼Œæœ‰ç°æˆçš„ [paramiko](https://github.com/paramiko/paramiko) åº“å¯ä»¥ä½¿ç”¨ï¼›ç¬¬äºŒç§æ–¹æ¡ˆæ˜¯åœ¨æœ¬æœºæ‰§è¡Œ `ssh user@ip` æŒ‡ä»¤ï¼Œç„¶åæˆ‘ä»¬ä¸ ssh è¿›ç¨‹è¿›è¡Œæœ¬åœ°é€šè®¯ã€‚æ­¤æ–¹æ¡ˆå¯ä»¥ä½¿ç”¨ [pexpect](https://github.com/pexpect/pexpect) åº“å®ç°ã€‚

è€ƒè™‘åˆ°æ–¹æ¡ˆäºŒçš„å¯æ‰©å±•æ€§ä¼˜äºæ–¹æ¡ˆä¸€ï¼ˆä¸ä»…èƒ½æ”¯æŒ sshï¼Œä¹Ÿèƒ½æ”¯æŒå…¶ä»–å‘½ä»¤è¡Œç¨‹åºï¼‰ï¼Œæˆ‘ä»¬é€‰æ‹©äº† pexpectã€‚ä½¿ç”¨æ–¹æ³•æ˜¯ï¼šå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œç­‰å¾…å®ƒå‘æ¥æŸä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åå‘é€æˆ‘ä»¬çš„ payloadï¼Œå¦‚æ­¤å¾ªç¯ï¼Œç›´åˆ°å®Œæˆä»»åŠ¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦è°ƒç”¨ `passwd` å·¥å…·ä¿®æ”¹å¯†ç ï¼Œåˆ™éœ€è¦å…ˆè¾“å…¥æ—§å¯†ç ï¼Œå†è¾“å…¥ä¸¤æ¬¡æ–°å¯†ç ï¼š

![](https://www.ruanx.net/content/images/2024/12/image-2.png)

ä½¿ç”¨ pexpectï¼Œæˆ‘ä»¬çš„å·¥ä½œæµç¨‹å°±æ˜¯ï¼šå¯åŠ¨ `passwd` è¿›ç¨‹ï¼Œç­‰å¾…å‡ºç° `Current password:` å­—ç¬¦ä¸²ï¼Œç„¶åå‘é€æ—§å¯†ç ï¼›ç­‰å¾…å‡ºç° `New password:` å­—ç¬¦ä¸²ï¼Œå‘é€æ–°å¯†ç ï¼›ç­‰å¾…å‡ºç° `Retype new password:`ï¼Œå†æ¬¡å‘é€æ–°å¯†ç ã€‚ä»£ç å¦‚ä¸‹ï¼š

```python
import pexpect

io = pexpect.spawn('passwd')
io.expect('Current password:')
io.sendline('-----------')
io.expect('New password:')
io.sendline('***********')
io.expect('Retype new password:')
io.sendline('***********')
print(io.read())
# b' \r\npasswd: password updated successfully\r\n'
```

ğŸ’¡

äº‹å®ä¸Šï¼Œä¹Ÿå¯ä»¥é€šè¿‡ pwntools å®ç°ï¼Œç›¸å…³ä»£ç è§ [pwnlib/term/term.py](https://github.com/Gallopsled/pwntools/blob/dev/pwnlib/term/term.py)ã€‚ç”±äº pexpect æ˜¯ä¸“ä¸ºæ­¤ç”¨é€”è®¾è®¡çš„ï¼Œç›¸å…³æ–‡æ¡£å®¹æ˜“æ‰¾åˆ°ï¼Œæ‰€ä»¥æœ¬æ–‡é‡‡ç”¨ pexpectã€‚

å›é¡¾ ssh å¯†ç ç™»å½•æµç¨‹ã€‚æœåŠ¡å™¨ä¼šå‘æ¥ `xxx's password:` å­—ç¬¦ä¸²ï¼Œåœ¨æ­¤ä¹‹åæˆ‘ä»¬è¾“å…¥å¯†ç ï¼Œè¿›å…¥æœåŠ¡å™¨çš„ shellã€‚

![](https://www.ruanx.net/content/images/2024/12/image-4.png)

å› æ­¤ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ `df -h` æŸ¥çœ‹ç£ç›˜å ç”¨ï¼Œæˆ‘ä»¬åªéœ€å†™å‡ºä»¥ä¸‹ä»£ç ï¼š

```python
import pexpect
import os

io = pexpect.spawn(
    'ssh neko@192.168.8.200',
    logfile=open('log', 'wb')
)

io.expect_exact('password:')
io.sendline(os.environ['PASSWD'])

io.expect_exact('$')
io.sendline('df -h')
io.expect_exact('$')

print(io.before, io.after)
# b' df -h\r\n\x1b[?2004l\rFilesystem      Size  Used Avail Use% Mounted on\r\nudev            7.8G     0  7.8G   0% /dev\r\ntmpfs           1.6G  744K  1.6G   1% /run\r\n/dev/sda1       294G  1.5G  277G   1% /\r\ntmpfs           7.9G     0  7.9G   0% /dev/shm\r\ntmpfs           5.0M     0  5.0M   0% /run/lock\r\ntmpfs           1.6G     0  1.6G   0% /run/user/1000\r\n\x1b[?2004h\x1b]0;neko@center: ~\x07\x1b[01;32mneko@center\x1b[00m:\x1b[01;34m~\x1b[00m' b'$'
```

æä¾› `logfile` å‚æ•°ä¹‹åï¼Œpexpect ä¼šå°†é€šè®¯å­—èŠ‚æµå†™å…¥æ—¥å¿—æ–‡ä»¶ï¼Œå¾ˆæ–¹ä¾¿è°ƒè¯•ã€‚ä»£ç ä¸­é‡‡ç”¨äº† `io.expect_exact()` æ–¹æ³•è€Œé `io.expect()`ï¼Œå› ä¸ºåè€…åŒ¹é…çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œå‰è€…æ˜¯ç›´æ¥åŒ¹é…å­—ç¬¦ä¸²ã€‚å½“åŒ¹é…å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è¯»å– `io.before` è·å¾—åŒ¹é…å‰çš„å­—ç¬¦ä¸²ï¼Œè¯»å– `io.after` è·å¾—åŒ¹é…ä¹‹åçš„å­—ç¬¦ä¸²ã€‚

ä¸è¿‡ï¼Œæˆ‘ä»¬å‘ç°ï¼Œè¯»å‡ºçš„å­—ç¬¦ä¸²é‡Œé¢åŒ…å«æœ‰ä¸€äº›ç‰¹æ®Šå­—ç¬¦ã€‚è¿™äº›æ˜¯ ANSI escape codeï¼Œå¯ä»¥ç”¨äºå®ç°æ–‡æœ¬é¢œè‰²ç­‰åŠŸèƒ½ï¼Œè¯¦æƒ…å¯è§ [Burke Libbey çš„ä¸€ç¯‡æ–‡ç« ](https://notes.burke.libbey.me/ansi-escape-codes/)ã€‚æˆ‘ä»¬ä¹‹åä½¿ç”¨ `htop` ç­‰æŒ‡ä»¤æ—¶ï¼ŒæœåŠ¡å™¨è¿˜ä¼šå‘æ¥æ›´å¤šçš„æ§åˆ¶å­—ç¬¦ã€‚**æˆ‘ä»¬éœ€è¦æ¨¡æ‹Ÿå‡ºä¸€ä¸ªç»ˆç«¯ï¼Œåè¿›è¿™äº›å­—èŠ‚æµï¼Œç„¶åæ¸²æŸ“å‡ºç•Œé¢â€”â€”æ¯ä¸ªä½ç½®æ˜¯å“ªä¸ªå­—ç¬¦ã€æ˜¯ä»€ä¹ˆé¢œè‰²ã€‚**æœ‰ [selectel/pyte](https://github.com/selectel/pyte) åº“å¯ä»¥ç”¨äºæ­¤é¡¹å·¥ä½œã€‚

ğŸ’¡

æˆ‘ä»¬è‡ªå·±ç”µè„‘ä¸Šä½¿ç”¨çš„ç»ˆç«¯ï¼Œä¾‹å¦‚ Windows Terminalï¼Œéƒ½æ˜¯æ”¯æŒ VT-xxx æ§åˆ¶å­—ç¬¦çš„ã€‚ä»è€Œï¼Œè‹¥æˆ‘ä»¬ç›´æ¥ `print` å‡ºè¿™äº›æ§åˆ¶å­—ç¬¦ï¼Œå±å¹•ä¸Šä¹Ÿèƒ½æ˜¾ç¤ºæ­£ç¡®çš„æ¸²æŸ“ç»“æœã€‚è¿™å¯ä»¥å¸®åŠ©åˆ¤æ–­æˆªå–çš„å­—èŠ‚æµæ˜¯å¦åˆé€‚ã€‚

ğŸ’¡

å¯ä»¥è°ƒç”¨ `io.interact()` ä½¿ pexpect è¿›å…¥äº¤äº’çŠ¶æ€ï¼Œè¿™ä¹Ÿæ˜¯è°ƒè¯•åˆ©å™¨ã€‚è¡Œä¸ºç±»ä¼¼äº pwntools çš„ `io.interactive()`ã€‚

### 0x02 åŸºç¡€å·¥å…·ï¼šåˆ©ç”¨ pyte è§£æ ANSI å­—èŠ‚æµ

pyte çš„ä½¿ç”¨æ–¹æ³•æ˜¯ï¼šå»ºç«‹ä¸€ä¸ªæŒ‡å®šå°ºå¯¸çš„è™šæ‹Ÿç»ˆç«¯ï¼›å–‚è¿›å­—èŠ‚æµï¼›è¯»å–è™šæ‹Ÿç»ˆç«¯çš„çŠ¶æ€ã€‚åŸºç¡€ä»£ç ï¼š

```python
import pyte

term = pyte.Screen(120, 80)
stream = pyte.Stream(term)

raw_bytes = b' df -h\r\n\x1b[?2004l\rFilesystem      Size  Used Avail Use% Mounted on\r\nudev            7.8G     0  7.8G   0% /dev\r\ntmpfs           1.6G  744K  1.6G   1% /run\r\n/dev/sda1       294G  1.5G  277G   1% /\r\ntmpfs           7.9G     0  7.9G   0% /dev/shm\r\ntmpfs           5.0M     0  5.0M   0% /run/lock\r\ntmpfs           1.6G     0  1.6G   0% /run/user/1000\r\n\x1b[?2004h\x1b]0;neko@center: ~\x07\x1b[01;32mneko@center\x1b[00m:\x1b[01;34m~\x1b[00m'
stream.feed(raw_bytes.decode())

print('\n'.join(term.display))
```

è¿è¡Œç»“æœï¼š

![](https://www.ruanx.net/content/images/2024/12/image-5.png)

æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ `term.display` ç›´æ¥è¯»å‡ºå­—ç¬¦ä¸²ï¼Œä¸¢å¤±äº†é¢œè‰²ä¿¡æ¯ã€‚æƒ³è·å–å‰æ™¯è‰²ã€èƒŒæ™¯è‰²ã€æ˜¯å¦åŠ ç²—ç­‰ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ `term.buffer`ã€‚

```python
print(term.buffer[0][0])
# Char(data=' ', fg='default', bg='default', bold=False, italics=False, underscore=False, strikethrough=False, reverse=False)
```

æˆ‘ä»¬å¯ä»¥ä» `term.buffer` ç”Ÿæˆå¸¦é¢œè‰²æ ‡ç­¾çš„ htmlï¼Œä»£ç å¦‚ä¸‹ï¼š

```python
def ansi_raw_to_html(s):
    screen = pyte.Screen(n_cols, n_rows)
    stream = pyte.Stream(screen)

    if type(s) == bytes:
        s = s.decode("utf8")
    stream.feed(s)

    buf = ""

    def get_classes(c):
        classes = []
        for key in [
            "fg",
            "bg",
            "bold",
            "italics",
            "underscore",
            "strikethrough",
            "reverse",
        ]:
            val = getattr(c, key)

            match val:
                case str():
                    if val != "default":
                        classes.append(f"{key}-{val}")
                case bool():
                    if val:
                        classes.append(key)

        return " ".join(classes)

    for x in range(n_rows):
        t = []

        for y in range(n_cols):
            a = screen.buffer[x][y]

            cs = get_classes(a)
            t.append((cs, html.escape(a.data)))

        buf += '<div class="term-line">'

        for cs, chars in itertools.groupby(t, key=lambda z: z[0]):
            buf += '<code class="{}">{}</code>'.format(
                cs, "".join(map(lambda z: z[1], chars))
            )

        buf += "</div>"

    empty_line = f'<div class="term-line"><code class="">{" " * n_cols}</code></div>'
    while buf.startswith(empty_line):
        buf = buf[len(empty_line) :]
    while buf.endswith(empty_line):
        buf = buf[: -len(empty_line)]

    buf = '<pre class="term-block">' + buf + "</pre>"

    r = jinja2.Template(
        open(os.path.join("share", "base.html"), encoding="utf8").read()
    ).render(body=buf)

    with open(os.path.join("tmp", "term.html"), "w", encoding="utf8") as f:
        f.write(r)
    return buf
```

æ¨¡æ¿æ–‡ä»¶ `base.html` å¦‚ä¸‹ï¼š

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        body{
            font-family: 'Sarasa Fixed SC';
        }

        pre, code{
            font-family: 'Sarasa Fixed SC';
            font-size: 14px;
        }

        .term-block{
            background-color: #eeeeee;
            margin: 0 0 4px 0;
            padding: 2px;
            border: 1px solid #dddddd;
        }

        .fg-black{color: black;}
        .fg-red{color: rgba(255, 0, 0, 70%);}
        .fg-green{color: green;}
        .fg-brown{color: brown;}
        .fg-blue{color: blue;}
        .fg-magenta{color: magenta;}
        .fg-cyan{color: hsl(198, 99%, 37%);}
        .fg-white{color: gray;}
        .fg-default{color: black;}

        .bg-black{background-color: black;}
        .bg-red{background-color: red;}
        .bg-green{background-color: hsl(0.3turn 60% 45% / .7);}
        .bg-brown{background-color: brown;}
        .bg-blue{background-color: blue;}
        .bg-magenta{background-color: magenta;}
        .bg-cyan{background-color: hsl(198, 99%, 90%);}
        .bg-white{background-color: gray;}
        .bg-default{background-color: white;}

    </style>
</head>
<body>
{% block body %}
{{body}}
{% endblock %}
</body>
</html>
```

æ•ˆæœï¼š

![](https://www.ruanx.net/content/images/2024/12/image-7.png)

ä½¿ç”¨ wkhtmltopdf ç”Ÿæˆ PDF æ–‡ä»¶ï¼š

```bash
wkhtmltopdf --encoding utf8 --page-width 260mm --page-height 4500mm report.html out.pdf
```

è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®ç°â€œé€šè¿‡ ssh è‡ªåŠ¨å‘é€æŒ‡ä»¤ï¼Œå¹¶æ¸²æŸ“å‡ºå¸¦é¢œè‰²çš„ htmlâ€ã€‚ssh å·¡æ£€çš„è‡ªåŠ¨åŒ–å·²ç»åŸºæœ¬å®Œæˆï¼Œæ¥ä¸‹æ¥è€ƒè™‘æµè§ˆå™¨çš„è‡ªåŠ¨åŒ–ã€‚

### 0x03 åŸºç¡€å·¥å…·ï¼šåˆ©ç”¨ selenium å®ç°æµè§ˆå™¨è‡ªåŠ¨åŒ–

æœ¬ç«™[å››å¹´å‰çš„æ–‡ç« ](https://www.ruanx.net/selenium/)å·²ç»ä½¿ç”¨è¿‡ seleniumï¼Œä»Šæ¬¡ç»§ç»­ç”¨å®ƒå®ç°æµè§ˆå™¨å·¡æ£€ã€‚å†™ä»£ç çš„è¿‡ç¨‹æ²¡æœ‰å¤šå°‘å¥½è¯´ï¼Œä¸è¿‡æœ‰å‡ ä¸ªå‘ç‚¹éœ€è¦æ³¨æ„ï¼š

**ä¸å®œä½¿ç”¨** `**sleep(10)**` **ç­‰å¾…é¡µé¢åŠ è½½ã€‚**å½±å“é¡µé¢åŠ è½½é€Ÿåº¦çš„å› ç´ éå¸¸å¤šï¼Œä¾‹å¦‚ç”µè„‘çš„æ€§èƒ½ã€ç½‘é€Ÿã€æœ‰å¦é™æ€æ–‡ä»¶ç¼“å­˜ç­‰ã€‚å¼ºè¡ŒæŒ‡å®šç­‰å¾…æ—¶é—´ï¼Œå¾ˆå®¹æ˜“åœ¨é¡µé¢æœªåŠ è½½å®Œæˆçš„æƒ…å†µä¸‹ä¾¿è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼›è‹¥ç­‰å¾…æ—¶é—´è®¾ç½®è¿‡é•¿ï¼Œåˆ™é€ æˆæµªè´¹ã€‚åˆç†çš„æ–¹æ¡ˆæ˜¯è½®è¯¢æŸä¸ªæ¡ä»¶ï¼Œä¾‹å¦‚ï¼š

```python
def wait_for_web(b):
    time.sleep(2)
    while "Loading" in b.page_source:
        time.sleep(1)
    time.sleep(2)
```

**è‹¥é¡µé¢ä¸Šæœ‰ iframeï¼Œåˆ™ `b.find_element` æ— æ³•ç›´æ¥å®šä½åˆ° iframe å†…éƒ¨çš„ DOMã€‚**éœ€è¦å…ˆåˆ‡æ¢åˆ°ç‰¹å®šçš„ iframeï¼š

```python
iframe = b.find_element(
    By.CSS_SELECTOR,
    "iframe[src='/page/aloha/oe']",
)
b.switch_to.frame(iframe)
```

**æ–°ç‰ˆ selenium æ¯”èµ·å½“å¹´çš„ç‰ˆæœ¬ï¼Œå¼•å…¥äº† Selenium Manager å·¥å…·ï¼Œä»¥ç®¡ç†å„ç§ driverã€‚**è¿™ä¸ªå·¥å…·å¯¹å±€åŸŸç½‘ç¯å¢ƒæä¸å‹å¥½ï¼Œæˆ‘ä»¬æœ‰å¿…è¦ç¦ç”¨ä¹‹ï¼Œè½¬è€Œä½¿ç”¨è‡ªå·±æä¾›çš„ driverã€‚å†™æ³•å¦‚ä¸‹ï¼š

```python
os.environ["SE_OFFLINE"] = "true"

gecko_path = os.environ['GECKODRIVER_PATH']

arg = {}

if gecko_path:
    arg['executable_path'] = gecko_path
         
service = webdriver.FirefoxService(**arg)
self.browser = webdriver.Firefox(service=service)
```

ğŸ’¡

pexpect ä»…æ”¯æŒ Linuxï¼Œä½†ç¬”è€…æ˜¯åœ¨ Windows ä¸‹ä½¿ç”¨ selenium çš„ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¤§è‡´æœ‰ä¸‰ç§æ–¹æ¡ˆï¼š  
\- åœ¨ wsl é‡Œé¢è·‘ ssh å·¡æ£€ï¼Œåœ¨ Windows è·‘æµè§ˆå™¨å·¡æ£€ï¼Œéœ€è¦ä»£ç åšå¥½éš”ç¦»ï¼Œä¸è¦äº§ç”Ÿ import é”™è¯¯  
\- ä½¿ç”¨å¸¦æ¡Œé¢çš„ Linux ç³»ç»Ÿ  
\- é«˜ç‰ˆæœ¬çš„ wsl 2 å¯ä»¥æä¾›å›¾å½¢ç•Œé¢ï¼Œè§[å¾®è½¯çš„æ–‡æ¡£](https://learn.microsoft.com/en-us/windows/wsl/tutorials/gui-apps) ï¼ˆè¿™æ˜¯ç¬”è€…æœ€åé‡‡å–çš„æ–¹æ¡ˆï¼‰

### 0x04 æ•æ·å¼€å‘

ç¬”è€…ä¸€è¾¹ç ”ç©¶ pexpect ç­‰å·¥å…·çš„ä½¿ç”¨ï¼Œä¸€è¾¹ç¼–å†™äº†åŸå‹ç³»ç»Ÿã€‚é¡¹ç›®ç»„ç»‡ä¸Šï¼Œå°†æ™®éå¯å¤ç”¨çš„ä»£ç ï¼ˆä¾‹å¦‚ä» ANSI å­—èŠ‚æµæ¸²æŸ“ htmlï¼‰æ”¾è¿›äº† `util` ç›®å½•ï¼Œç„¶åæ¯ä¸ªç³»ç»Ÿå„è‡ªå®ç°ä¸€éå·¡æ£€ä¸šåŠ¡é€»è¾‘ã€‚ç›®å½•ç»“æ„å¤§è‡´æ˜¯ï¼š

```plaintext
.
â”œâ”€â”€ 1-clean.cmd
â”œâ”€â”€ 2-go-A.cmd
â”œâ”€â”€ 3-go-B.cmd
â”œâ”€â”€ 4-gen-report.cmd
â”œâ”€â”€ autoins_A1-1.py
â”œâ”€â”€ autoins_A1-2.py
â”œâ”€â”€ autoins_A2-1.py
â”œâ”€â”€ autoins_A2-2.py
â”œâ”€â”€ autoins_B1-1.py
â”œâ”€â”€ autoins_B1-2.py
â”œâ”€â”€ autoins_B2-1.py
â”œâ”€â”€ autoins_B2-2.py
â”œâ”€â”€ clean.py
â”œâ”€â”€ gen_A_report.py
â”œâ”€â”€ gen_B_report.py
â”œâ”€â”€ template
â”‚Â Â  â””â”€â”€ base.html
â”œâ”€â”€ util
â”‚Â Â  â”œâ”€â”€ db.py
â”‚Â Â  â””â”€â”€ term.py
â”œâ”€â”€ wkhtmltopdf.exe
â””â”€â”€ worklog.db
```

ç„¶è€Œï¼Œæˆ‘ä»¬å­˜åœ¨è¿™æ ·çš„æƒ…å†µï¼šä¸¤å°æœåŠ¡å™¨ä¸Šéƒ¨ç½²äº†ç›¸åŒçš„åº”ç”¨ï¼Œå®ƒä»¬ IP ä¸ä¸€è‡´ï¼Œå¯†ç ä¸ä¸€è‡´ï¼Œè€Œä¸”ç”±äºç‰ˆæœ¬ä¸åŒï¼Œå¯èƒ½æµç¨‹ä¸Šæœ‰ç»†å¾®å·®åˆ«ã€‚åœ¨åŸå‹ç³»ç»Ÿä¸­ï¼Œç¬”è€…å…ˆå¼€å‘äº† X ç³»ç»Ÿçš„å·¡æ£€é€»è¾‘ï¼Œç„¶åå°†å…¶å¤åˆ¶å‡ºæ¥ï¼Œä¿®æ”¹å‡º Y ç³»ç»Ÿçš„å·¡æ£€ä»£ç ã€‚æœ€ç»ˆï¼Œä¸¤ä»½ä»£ç çš„å¤§éƒ¨åˆ†éƒ½æ˜¯ç›¸åŒçš„ã€‚è¿™æ ·çš„åšæ³•è¿åäº†è®¾è®¡æ¨¡å¼ï¼ˆDon't repeat yourselfï¼‰ï¼Œå¾ˆä¸é€‚åˆç»´æŠ¤ã€‚æˆ‘ä»¬éœ€è¦é‡æ–°è®¾è®¡è‡ªåŠ¨å·¡æ£€ç³»ç»Ÿã€‚

### 0x05 æ–°çš„è®¾è®¡

è®©æˆ‘ä»¬å›æƒ³ä¸€æ¬¡ ssh å·¡æ£€æµç¨‹ï¼š

1.  ç™»å½• sshï¼ˆåœ¨ä¸åŒçš„ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼ŒIPã€ç«¯å£ã€å¯†ç ç­‰å‚æ•°ä¸åŒï¼‰
2.  æ‰§è¡Œ `df -h`
3.  æ‰§è¡Œ `htop`
4.  æ‰§è¡Œå…¶ä»–æŒ‡ä»¤ï¼ˆæ¯ä¸ªä¸šåŠ¡ç³»ç»Ÿæœ‰å„è‡ªçš„ç‰¹æ®ŠæŒ‡ä»¤è¦æ‰§è¡Œï¼‰

è€Œä¸€æ¬¡å…¸å‹çš„æµè§ˆå™¨å·¡æ£€æµç¨‹å¦‚ä¸‹ï¼š

1.  ç™»å½•ï¼ˆå„ä¸ªç³»ç»Ÿç™»å½•é€»è¾‘ä¸åŒï¼‰ï¼Œæˆªå›¾
2.  è¿›å…¥ A é¡µé¢ï¼Œæˆªå›¾
3.  è¿›å…¥ B é¡µé¢ï¼Œæ‰§è¡ŒæŸæ“ä½œï¼Œæˆªå›¾

æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå·¡æ£€å¯ä»¥æ‹†åˆ†æˆä¸åŒçš„æ­¥éª¤ï¼ˆStepï¼‰ï¼Œä¾‹å¦‚â€œæ‰§è¡Œ `df -h`â€å°±æ˜¯ä¸€ä¸ªæ­¥éª¤ã€‚æ­¥éª¤çš„åºåˆ—æ„æˆäº†å·¡æ£€è¿‡ç¨‹ï¼Œæˆ‘ä»¬åªéœ€è¦æ‹¼æ¥å„ç§æ­¥éª¤ï¼Œå½¢æˆæ­¥éª¤é“¾ï¼ˆWorkChainï¼‰ï¼Œå°±å¯ä»¥å®Œå…¨æè¿°ä¸€åœºå·¡æ£€ã€‚è€Œæ­¥éª¤çš„å¯å¤ç”¨æ€§å¾ˆé«˜ï¼Œä»¥â€œæ‰§è¡Œ `df -h`â€è¿™ä¸ªæ­¥éª¤ä¸ºä¾‹ï¼Œæˆ‘ä»¬åªéœ€è¦å‘ ssh è¿›ç¨‹å‘é€ä¸€å¥ `df -h`ï¼Œç„¶åç­‰å¾…å‡ºç° `$` ç¬¦å·æˆ– `#` ç¬¦å·ï¼ˆè¿™ä»£è¡¨ç€ `df` å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œshell å‘å›äº†å½¢å¦‚ `neko@lab:~$` çš„å­—ç¬¦ä¸²ï¼Œç­‰å¾…ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼‰ã€‚æˆ‘ä»¬åªéœ€è¦å®ç°ä¸€æ¬¡ `df -h` æ­¥éª¤ï¼Œå°±èƒ½åœ¨æ‰€æœ‰çš„ ssh å·¡æ£€ä¸­ä½¿ç”¨ä¹‹ã€‚æ›´è¿›ä¸€æ­¥åœ°ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°é€šç”¨çš„â€œæ‰§è¡Œç»ˆç«¯æŒ‡ä»¤â€æ­¥éª¤ï¼Œä»è¿™ä¸ªé€šç”¨æ­¥éª¤æ´¾ç”Ÿå‡º `df -h`ã€`uname -a` ç­‰å„ç§è¯¦ç»†æ­¥éª¤ã€‚

äºæ˜¯ï¼Œæˆ‘ä»¬åº”è¯¥ä¼šæœ‰è¿™æ ·çš„ä»£ç ï¼š

```python
class StepCommand(Step):
    def __init__(self, cmd, shell_prompt):
        # ...

    def exec(self):
        # ...

class StepLogin(Step):
    # ...

class StepDf(StepCommand):
    def __init__(self, shell_prompt):
        super().__init__('df -h', shell_prompt)

class StepUname(StepCommand):
    def __init__(self, shell_prompt):
        super().__init__('uname -a', shell_prompt)


c = WorkChain("æµ‹è¯•é“¾")
c.step(StepLogin('$'))
c.step(StepDf('$'))
c.step(StepUname('$'))
c.work()
```

è¿™ä»½ä»£ç æœ‰ä¸¤ä¸ªé—®é¢˜ã€‚é¦–å…ˆï¼Œ`StepCommand` çš„ `exec` æ–¹æ³•æ˜¯éœ€è¦æœ‰ pexpect å¯¹è±¡çš„ï¼Œè€Œè¿™ä¸ªå¯¹è±¡ç”± `StepLogin` äº§ç”Ÿã€‚æˆ‘ä»¬ä¸å®œå°† pexpect å¯¹è±¡æ”¾è¿›å…¨å±€å˜é‡ï¼Œæ‰€ä»¥**åº”å½“åœ¨ `WorkChain` å¯¹è±¡ä¸­ç»´æŠ¤ä¸€ä¸ª contextï¼Œå®ƒæ˜¯ä¸€ä¸ª `map`ï¼Œä¸“é—¨ç”¨äºå­˜æ”¾ä¸æ­¤ `WorkChain` ç›¸å…³çš„å„ç§å¯¹è±¡ã€‚**æ˜¾ç„¶ï¼Œ`shell_prompt` ä¹Ÿå¯ä»¥æ”¾è¿› contextï¼Œäºæ˜¯æˆ‘ä»¬å°±åªéœ€åœ¨ `StepLogin` æ­¥éª¤æä¾› `shell_prompt` ï¼Œè€Œæ— éœ€åœ¨æ¯æ¬¡å®ä¾‹åŒ– `StepDf` ç­‰æ­¥éª¤æ—¶éƒ½æä¾›ä¸€éã€‚

å¦ä¸€ä¸ªé—®é¢˜åœ¨äºï¼Œ**æœ‰äº›æ­¥éª¤æ‰“å¼€äº†èµ„æºï¼Œæˆ‘ä»¬éœ€è¦åœ¨åˆé€‚çš„æ—¶æœºäºˆä»¥å…³é—­ã€‚**ä¾‹å¦‚ï¼Œ`StartBrowser` æ­¥éª¤ä¼šæ‰“å¼€æµè§ˆå™¨ï¼ŒæŒ‰ç…§ç›®å‰çš„è®¾è®¡ï¼Œæˆ‘ä»¬éœ€è¦å†å®ç°ä¸€ä¸ª `CloseBrowser` æ­¥éª¤ï¼Œåœ¨å·¡æ£€çš„æœ€åæ—¶åˆ»æ‰§è¡Œï¼Œä»¥å…³æ‰æµè§ˆå™¨ã€‚æˆ‘ä»¬åˆ†åˆ«å®ç°å¼€å¯ã€å…³é—­ä¸¤ä¸ªæ­¥éª¤æ˜¯ä¸é›…è§‚çš„ï¼Œå¦‚æœæˆ‘ä»¬æ‰‹ä¸Šçš„èµ„æºå¾ˆå¤šï¼ˆä¾‹å¦‚åœ¨æŸæ¬¡å·¡æ£€ä¸­åŒæ—¶æ‰“å¼€ 3 ä¸ªæµè§ˆå™¨å’Œ 2 ä¸ª sshï¼‰ï¼Œä¼šé€ æˆä¸ä¾¿ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æå‡º `Resource` ç±»ï¼Œå®ƒåœ¨å·¡æ£€ä¹‹åˆæ‰§è¡Œ `init()` æ–¹æ³•ï¼Œåœ¨å·¡æ£€ç»“æŸæ—¶æ‰§è¡Œ `close()` æ–¹æ³•ã€‚

æœ€ç»ˆï¼Œæˆ‘ä»¬ä¸€å¥—å·¡æ£€é€»è¾‘çš„ä»£ç å¦‚ä¸‹ï¼š

```python
c = WorkChain("sshæµ‹è¯•é“¾")
c.resource(
    "ssh",
    RemoteTerminal(["user@host"], os.environ["PWD_TEST"],shell_prompt="$")
)
# æ­¤åå¯ä»¥é€šè¿‡ c.res['ssh'] è®¿é—®åˆ° RemoteTerminal å¯¹è±¡

c.step(StepCommand("cat /etc/issue"))
c.step(StepCommand("ps aux"))
c.step(StepCommand("screenfetch"))
c.step(StepHtop())

c.work()
```

ğŸ’¡

è°ƒè¯•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `IPython.embed()` è¿›å…¥ IPython äº¤äº’ç¯å¢ƒï¼Œè¿™å¯¹äº selenium éå¸¸æœ‰ç”¨ã€‚





ç›˜ç‚¹å¸‚é¢ä¸Šå¸¸è§å¥½ç”¨çš„ç½‘ç«™æ€§èƒ½ç›‘æµ‹ä¸æœåŠ¡å¯ç”¨æ€§ç›‘æµ‹å·¥å…·ï¼Œä»¥ä¸‹å·¥å…·å„æœ‰æ‰€é•¿ï¼Œæœ‰éœ€æ±‚è‡ªå–ã€‚

## ç½‘ç«™æ€§èƒ½æ£€æµ‹

### 1. ç™¾å·äº‘

- ç”±é•¿äº­ç§‘æŠ€æä¾›ï¼Œä¸€å®¶ä¸“æ³¨äºç½‘å®‰çš„å®åŠ›å‚å•†ã€‚
- ç™¾å·äº‘ç½‘ç«™ç›‘æµ‹ï¼šé•¿äº­ç§‘æŠ€è‡ªç ”çš„ç½‘ç«™ç¨³å®šæ€§ã€å®‰å…¨æ€§ç›‘æ§ saas åº”ç”¨å·¥å…·
- ä½“éªŒåœ°å€ï¼š[https://rivers.chaitin.cn/landing/radar](https://rivers.chaitin.cn/landing/radar)
    
    ### 2. GTmetrix
    
- ç”±GT[.net](https://so.csdn.net/so/search?q=.net&spm=1001.2101.3001.7020)æä¾›ï¼Œä¸€å®¶æä¾›æ‰˜ç®¡æœåŠ¡çš„å…¬å¸ã€‚
    
- Google PageSpeed Insightsï¼šç”±Googleå¼€å‘ï¼Œæ˜¯å…¶Webæ€§èƒ½å·¥å…·çš„ä¸€éƒ¨åˆ†ã€‚
    
- ä½“éªŒåœ°å€ï¼š[https://www.cloudflare-cn.com/](https://www.cloudflare-cn.com/)
    
    ## æœåŠ¡å¯ç”¨æ€§ç›‘æµ‹
    
    ### 1. ç™¾å·äº‘
    
- ç”±é•¿äº­ç§‘æŠ€æä¾›ï¼Œä¸€å®¶ä¸“æ³¨äº[ç½‘å®‰](https://so.csdn.net/so/search?q=%E7%BD%91%E5%AE%89&spm=1001.2101.3001.7020)çš„å®åŠ›å‚å•†ã€‚
    
- ç™¾å·äº‘ç½‘ç«™ç›‘æµ‹ï¼šé•¿äº­ç§‘æŠ€è‡ªç ”çš„ç½‘ç«™ç¨³å®šæ€§ã€[å®‰å…¨æ€§](https://so.csdn.net/so/search?q=%E5%AE%89%E5%85%A8%E6%80%A7&spm=1001.2101.3001.7020)ç›‘æ§ saas åº”ç”¨å·¥å…·
    
- ä½“éªŒåœ°å€ï¼š[https://rivers.chaitin.cn/landing/radar](https://rivers.chaitin.cn/landing/radar)
    
    ### 2. Pingdom
    
- ç”±SolarWindsæä¾›ï¼Œè¿™æ˜¯ä¸€å®¶æä¾›ITç®¡ç†è½¯ä»¶å’Œç›‘æ§å·¥å…·çš„å…¬å¸ã€‚
    
- ç®€åŒ–çš„ç½‘ç«™ç›‘æ§ï¼šè¿‡å¯¹ç½‘ç«™æ­£å¸¸è¿è¡Œæ—¶é—´å’Œæ€§èƒ½çš„å®æ—¶ã€å¯æ“ä½œçš„æ´å¯Ÿæ¥å¸®åŠ©æ‚¨æä¾›å“è¶Šçš„å®¢æˆ·ä½“éªŒï¼Œä»¥ä¾¿æ‚¨å¯ä»¥è®©æ‚¨çš„ç”¨æˆ·ä¸€æ¬¡åˆä¸€æ¬¡åœ°å›æ¥ã€‚
    
- ä½“éªŒåœ°å€ï¼š[https://www.pingdom.com/](https://www.pingdom.com/)
    
    ### 3. Uptime Robot
    
- ç”±Uptime Robot Ltd.æä¾›ï¼Œè¿™æ˜¯ä¸€å®¶ä¸“æ³¨äºç½‘ç«™ç›‘æ§çš„å…¬å¸ã€‚
    
- å…¨çƒé¢†å…ˆçš„æ­£å¸¸è¿è¡Œæ—¶é—´ç›‘æ§æœåŠ¡
    
- ä½“éªŒåœ°å€ï¼š[https://uptimerobot.com/](https://uptimerobot.com/)